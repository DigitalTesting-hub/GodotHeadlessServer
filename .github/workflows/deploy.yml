name: Deploy to Render

on:
  push:
    branches: [ main ]

jobs:
  build-and-export:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Godot
      uses: firebelley/setup-godot@v1
      with:
        godot-version: '4.2.1'
    
    - name: Export Headless Server
      run: |
        mkdir -p export/linux_server
        godot --headless --export "Linux Headless Server" export/linux_server/godot_server.x86_64
    
    - name: Upload artifacts
      uses: actions/upload-artifact@v3
      with:
        name: linux-server
        path: export/linux_server/
